[{
  "history_id" : "gH3d2kFJfzIW",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_5_Degree', 'Longitude_Coarse_5_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661429210286,
  "history_end_time" : 1661429288593,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "N8rHqJBGOJt8",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661421585756,
  "history_end_time" : 1661421646376,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "YIMC7s33wqn5",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Latitude']/0.1)\n    testing_df['Longitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661405991732,
  "history_end_time" : 1661406052072,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "r7nJ76R3TQjW",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree', 'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661401433710,
  "history_end_time" : 1661401493313,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "EHamZZhJ5vcn",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nTraceback (most recent call last):\n  File \"Test.py\", line 49, in <module>\n    pred = loaded_model.predict(X)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 783, in predict\n    X = self._validate_X_predict(X)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 421, in _validate_X_predict\n    return self.estimators_[0]._validate_X_predict(X, check_input=True)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/sklearn/tree/_classes.py\", line 396, in _validate_X_predict\n    raise ValueError(\"Number of features of the model must \"\nValueError: Number of features of the model must match the input. Model n_features is 4 and input n_features is 3 \n",
  "history_begin_time" : 1661401418141,
  "history_end_time" : 1661401421815,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "rE5rS6HHUv8f",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Latitude']/0.1)\n    testing_df['Longitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_0.1_Degree',\n       'Longitude_Coarse_0.1_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661393756380,
  "history_end_time" : 1661393823326,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "k0Hpn5CFBT9B",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_Coarse_5_Degree',\n       'Longitude_Coarse_5_Degree'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661388621166,
  "history_end_time" : 1661388687822,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "LqNcSA0GIQk3",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\n# testing_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Running",
  "history_begin_time" : 1661388056023,
  "history_end_time" : 1661388369840,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "TZvsEtYT6cJa",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS3/aalnaim/cmaq/testing_input_hourly'\n# testing_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_5_Degree'] = 5 * round(testing_df['Latitude']/5)\n    testing_df['Longitude_Coarse_5_Degree'] = 5 * round(testing_df['Longitude']/5)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : null,
  "history_begin_time" : 1661388006239,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : null
},{
  "history_id" : "tJ82ws9v9PvO",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Latitude']/0.1)\n    testing_df['Longitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(18, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661378444056,
  "history_end_time" : 1661378562940,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "nKWVyOI2GJnG",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Latitude']/0.1)\n    testing_df['Longitude_Coarse_0.1_Degree'] = 0.1 * round(testing_df['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\n# ax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_Coarse_0.1_Degree', 'Longitude_Coarse_0.1_Degree',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661377840343,
  "history_end_time" : 1661377943555,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "HKPcRIzxwEIV",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    testing_df['Latitude_ExtraCoarse'] = 0.1 * round(testing_df['Latitude']/0.1)\n    testing_df['Longitude_ExtraCoarse'] = 0.1 * round(testing_df['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_ExtraCoarse', 'Longitude_ExtraCoarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv\n",
  "history_begin_time" : 1661375050928,
  "history_end_time" : 1661375146527,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "GlWNcy18C84j",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\n# testing_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\ntesting_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\n    final['Longitude_ExtraCoarse'] = 0.1 * round(final['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Traceback (most recent call last):\n  File \"Test.py\", line 36, in <module>\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\nNameError: name 'final' is not defined\n",
  "history_begin_time" : 1661374988999,
  "history_end_time" : 1661375021911,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "xwMHgXJqpkNi",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\n# testing_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\n    final['Longitude_ExtraCoarse'] = 0.1 * round(final['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Running",
  "history_begin_time" : 1661372916855,
  "history_end_time" : 1661373026134,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "wn6yl85AJJqQ",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\n# testing_path = '/Users/uhhmed/localCMAQ/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\n    final['Longitude_ExtraCoarse'] = 0.1 * round(final['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Running",
  "history_begin_time" : 1661345695549,
  "history_end_time" : 1661373025565,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "TKO7mkvDVfcZ",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\n    final['Longitude_ExtraCoarse'] = 0.1 * round(final['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Running",
  "history_begin_time" : 1661335630695,
  "history_end_time" : 1661335925355,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "NmjUbIpufGZ0",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    final['Latitude_ExtraCoarse'] = 0.1 * round(final['Latitude']/0.1)\n    final['Longitude_ExtraCoarse'] = 0.1 * round(final['Longitude']/0.1)\n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "",
  "history_begin_time" : 1661329724074,
  "history_end_time" : 1661335659576,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "4Ku5jqfzbedk",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names seen at fit time, yet now missing:\n- Latitude_ExtraCoarse\n- Longitude_ExtraCoarse\n- time_of_day\n\n  warnings.warn(message, FutureWarning)\nTraceback (most recent call last):\n  File \"Test.py\", line 46, in <module>\n    pred = loaded_model.predict(X)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 971, in predict\n    X = self._validate_X_predict(X)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 579, in _validate_X_predict\n    X = self._validate_data(X, dtype=DTYPE, accept_sparse=\"csr\", reset=False)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py\", line 585, in _validate_data\n    self._check_n_features(X, reset=reset)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py\", line 400, in _check_n_features\n    raise ValueError(\nValueError: X has 15 features, but RandomForestRegressor is expecting 18 features as input.\n",
  "history_begin_time" : 1661329325139,
  "history_end_time" : 1661329648599,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "HMMkKliCuuIq",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = '/groups/ESS/aalnaim/cmaq/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "Running",
  "history_begin_time" : 1661324005155,
  "history_end_time" : 1661329159622,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "gexB4XEzg0Go",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',  'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', ], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1661151868837,
  "history_end_time" : 1661329159053,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "LkE66ikTRSsY",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',  'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1661148905827,
  "history_end_time" : 1661329158553,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "GJ2RkuL5C8yN",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',  'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1661144944873,
  "history_end_time" : 1661329158001,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "duGI3Uhfifbv",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n#     testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n#     testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n#     testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PBL(m)', 'TEMP2(K)','WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1661048000118,
  "history_end_time" : 1661329157380,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "r1marTVItgJ4",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)',\n       'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)',\n       'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day',\n       'hours', 'Latitude_coarse', 'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660978592036,
  "history_end_time" : 1661329156887,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "ipym097pata",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'Latitude_coarse',\n       'Longitude_coarse', 'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660969414751,
  "history_end_time" : 1660973594880,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "Nosp3lpiWKM4",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    # Split time of day into value ranges.\n    # Hours 0 - 3 is value 1 (Midnight), 4 - 7 is value 2 (Early Morning), 8 - 11 is value 3 (Morning), 12 - 15 is value 4 (Noon), 16 - 19 is value 5 (Evening), 20 - 23 is value 6 (Night)\n    testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse',\n       'time_of_day'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660965391197,
  "history_end_time" : 1661329156286,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "Dqt7W0vT17Oc",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \", \".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Model Inputs: \"+usedInputs, fontsize=14)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660963070953,
  "history_end_time" : 1661329155730,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "pIrvSJbM1utd",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(15, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(usedInputs, fontsize=10)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660958934532,
  "history_end_time" : 1661329155078,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "USyzEFfB9f8L",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots(figsize=(20, 10))\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(usedInputs, fontsize=10)\nfig.suptitle(\"Feature importances\", fontsize=16)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660958795064,
  "history_end_time" : 1661329168429,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "41dsy8DKdy5L",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nfig.suptitle(usedInputs)\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660955149857,
  "history_end_time" : 1661329167825,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "orP3dHOFnH3n",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+\"/featImp/rf_importance_20220805_Inputs_\"+usedInputs+\".png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660954578851,
  "history_end_time" : 1661329167260,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "DcfWvQ2I72lL",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(cmaq_folder+'/featImp/rf_importance_20220805_Inputs_'+usedInputs+'.png')",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660954116600,
  "history_end_time" : 1661329166813,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "5xOohqhdQCAi",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(f'{cmaq_folder}/featImp/rf_importance_20220805_Inputs_{usedInputs}.png')",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660953824820,
  "history_end_time" : 1661329165294,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "4jLhesR6vACH",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\nusedInputs = \"__\".join(X.columns)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(f\"{cmaq_folder}/featImp/rf_importance_20220805_Inputs_{usedInputs}.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660953528032,
  "history_end_time" : 1661329165947,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "I11pfPYng5GH",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\nforest_importances = pd.Series(imp, index=feature_names)\n\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(f\"{cmaq_folder}/featImp/rf_importance_20220805_{X.columns}.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660953289371,
  "history_end_time" : 1661329163806,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "L9VF23wghJX6",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n\n    \n  \nimp = loaded_model.feature_importances_\nfeature_names = [i for i in X.columns]\nstd = np.std([tree.feature_importances_ for tree in loaded_model.estimators_], axis=0)\n\nfig, ax = plt.subplots()\nforest_importances.plot.barh(yerr=std, ax=ax)\nax.set_title(\"Feature importances\")\nax.set_xlabel(\"Mean decrease in impurity\")\nplt.savefig(f\"{cmaq_folder}/featImp/rf_importance_20220805_{X.columns}.png\")",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\nTraceback (most recent call last):\n  File \"Test.py\", line 64, in <module>\n    forest_importances.plot.barh(yerr=std, ax=ax)\nNameError: name 'forest_importances' is not defined\n",
  "history_begin_time" : 1660953167309,
  "history_end_time" : 1661329163236,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "q8gXssghTolR",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    # Make coords coarse by removing decimals\n    testing_df['Latitude_coarse'] = round(testing_df['Latitude'])\n    testing_df['Longitude_coarse'] = round(testing_df['Longitude'])\n    \n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'Latitude_coarse', 'Longitude_coarse'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660947465026,
  "history_end_time" : 1661329162314,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "GEXy6cwQwa3M",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude',  'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n                'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC'], axis=1)\n    # Make coords coarse by removing decimals\n#     X['Latitude'] = round(X['Latitude'])\n#     X['Longitude'] = round(X['Longitude'])\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'PRSFC(Pa)', 'month', 'day',\n       'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660905209594,
  "history_end_time" : 1661329161834,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "RX5sSayB8ZO3",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude',  'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC'], axis=1)\n    # Make coords coarse by removing decimals\n#     X['Latitude'] = round(X['Latitude'])\n#     X['Longitude'] = round(X['Longitude'])\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660882511789,
  "history_end_time" : 1661329171549,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "7GuAZHsuru35",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC'], axis=1)\n    # Make coords coarse by removing decimals\n#     X['Latitude'] = round(X['Latitude'])\n#     X['Longitude'] = round(X['Longitude'])\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'month', 'day', 'hours'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660874959328,
  "history_end_time" : 1660882495646,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "pmyv5yvci0g",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660874261202,
  "history_end_time" : 1660874422118,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "rf88ncl88y6",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# scaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    \n#     X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660873688412,
  "history_end_time" : 1660873854551,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "uMpv26Dfw1FY",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\nscaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n#     X['Latitude'] = round(X['Latitude'])\n#     X['Longitude'] = round(X['Longitude'])\n    \n    X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660873167291,
  "history_end_time" : 1660882356135,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "cT7OUxZJEnzT",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\nfrom sklearn.preprocessing import MinMaxScaler\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\nscaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    \n    X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660872835848,
  "history_end_time" : 1660882355763,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "0F1tgBJe3EcV",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\nscaler = MinMaxScaler(feature_range=(0, 1))\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    \n    X[X.columns] = scaler.fit_transform(X)\n    \n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "Traceback (most recent call last):\n  File \"Test.py\", line 15, in <module>\n    scaler = MinMaxScaler(feature_range=(0, 1))\nNameError: name 'MinMaxScaler' is not defined\n",
  "history_begin_time" : 1660872722216,
  "history_end_time" : 1660882354954,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "tmjw0MDhLbkk",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660871763781,
  "history_end_time" : 1660882353669,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "txdqEtkPtI6j",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n    # Make coords coarse by removing decimals\n    X['Latitude'] = round(X['Latitude'])\n    X['Longitude'] = round(X['Longitude'])\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : null,
  "history_begin_time" : 1660871595861,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : null
},{
  "history_id" : "wBT8lRJD8iaA",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    testing_df['Latitude'] = round(testing_df['Latitude'])\n    testing_df['Longitude'] = round(testing_df['Longitude'])\n    X = testing_df.drop(['YYYYMMDDHH'], axis=1)\n\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['Latitude', 'Longitude', 'CMAQ12KM_O3(ppb)', 'CMAQ12KM_NO2(ppb)',\n       'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)', 'PRSFC(Pa)',\n       'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)',\n       'CFRAC', 'month', 'day', 'hours'],\n      dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- Latitude\n- Longitude\nFeature names seen at fit time, yet now missing:\n- Latitude_x\n- Longitude_x\n\n  warnings.warn(message, FutureWarning)\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660870633326,
  "history_end_time" : 1660871582941,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "qkEimv8zOtYM",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660869839011,
  "history_end_time" : 1660871582436,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "pOgLVk6gvOBw",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n                'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\n/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.\nFeature names unseen at fit time:\n- PRSFC(Pa)\nFeature names must be in the same order as they were in fit.\n\n  warnings.warn(message, FutureWarning)\nTraceback (most recent call last):\n  File \"Test.py\", line 34, in <module>\n    pred = loaded_model.predict(X)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 971, in predict\n    X = self._validate_X_predict(X)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/ensemble/_forest.py\", line 579, in _validate_X_predict\n    X = self._validate_data(X, dtype=DTYPE, accept_sparse=\"csr\", reset=False)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py\", line 585, in _validate_data\n    self._check_n_features(X, reset=reset)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/sklearn/base.py\", line 400, in _check_n_features\n    raise ValueError(\nValueError: X has 2 features, but RandomForestRegressor is expecting 1 features as input.\n",
  "history_begin_time" : 1660869766716,
  "history_end_time" : 1660869823698,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "o4vgn2kMYPVL",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n                'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660869499098,
  "history_end_time" : 1660869823253,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "tk0qqp9xwfw",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PRSFC(Pa)', 'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660869055151,
  "history_end_time" : 1660869127410,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Done"
},{
  "history_id" : "t1xbl773rg1",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660868742286,
  "history_end_time" : 1660868966612,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "16fiwcq9rw7",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660868071714,
  "history_end_time" : 1660868142924,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Done"
},{
  "history_id" : "5yrh3uthxl2",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob\nimport os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{cmaq_folder}/models/rf_pycaret_o3_only.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n    #   print(testing_df['YYYYMMDDHH'].values[0])\n    file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n    X = testing_df.drop(['YYYYMMDDHH', 'Latitude', 'Longitude', 'CMAQ12KM_NO2(ppb)', 'CMAQ12KM_CO(ppm)', 'CMAQ_OC(ug/m3)', 'CO(moles/s)',\n               'PBL(m)', 'TEMP2(K)', 'WSPD10(m/s)', 'WDIR10(degree)', 'RGRND(W/m2)', 'CFRAC', 'month', 'day', 'hours'], axis=1)\n    print(\"used as inputs: \", X.columns)\n# # making prediction\n    pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n    testing_df['prediction'] = pred.tolist()\n\n    testing_df = testing_df[['Latitude',\n                             'Longitude', 'YYYYMMDDHH', 'prediction']]\n# saving the dataset into local drive\n    print(\n        f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n    testing_df.to_csv(\n        f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv', index=False)\n",
  "history_output" : "used as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080608.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080601.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080606.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080705.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080617.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080610.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080521.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080702.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080619.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080514.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080513.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080622.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080607.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080600.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080609.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080512.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080623.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080515.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080618.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080611.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080520.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080703.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080704.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080616.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080516.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080620.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080518.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080709.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080707.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080615.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080612.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080523.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080700.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080603.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080711.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080604.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080613.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080522.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080701.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080706.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080614.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080708.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080519.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080621.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080517.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080605.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080602.csv\nused as inputs:  Index(['CMAQ12KM_O3(ppb)', 'PRSFC(Pa)'], dtype='object')\nSaving: /groups/ESS/aalnaim/cmaq//prediction_files/prediction_rf_2022080710.csv\n",
  "history_begin_time" : 1660866108221,
  "history_end_time" : 1660867735012,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "wby9ocw87y6",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660874120839,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "vln41e9ulqh",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660874838842,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "2r0uo0qkp1j",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660881959503,
  "history_notes" : null,
  "history_process" : "zbw9k8",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},]
