[{
  "history_id" : "tulgDIWM3f8D",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661429386902,
  "history_end_time" : 1661429392500,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "9bEdvTTzPSst",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661421672500,
  "history_end_time" : 1661421678024,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "u1rik5y33Gx0",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661406421028,
  "history_end_time" : 1661406426055,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "1HUg2lQQUXIX",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661401533289,
  "history_end_time" : 1661401538847,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "imhpSUtBSVF8",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661393941921,
  "history_end_time" : 1661393946936,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "iPIRWIWRYzId",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661388871061,
  "history_end_time" : 1661388876807,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "1f8VFt1lEIWW",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661378109870,
  "history_end_time" : 1661378115679,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "4jQ2vzYJuz6N",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /Users/uhhmed/localCMAQ/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661375446949,
  "history_end_time" : 1661375451118,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "mHAOxS7NYpE2",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQ/prediction_files/\noverall hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080612.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080613.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080614.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080615.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080616.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080617.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080618.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080619.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080620.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080621.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080622.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080623.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080700.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080701.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080702.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080703.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080704.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080705.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080706.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080707.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080708.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080709.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080710.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080512.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080513.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080514.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080515.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080516.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080517.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080518.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080519.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080520.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080521.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080522.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080523.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080600.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080601.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080602.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080603.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080604.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080605.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080606.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080607.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080608.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080609.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080610.csv', '/Users/uhhmed/localCMAQ/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 199, in _acquire_with_cache_info\n    file = self._cache[self._key]\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/lru_cache.py\", line 53, in __getitem__\n    value = self._cache[key]\nKeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/Users/uhhmed/localCMAQprediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc',), 'a', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False))]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"netCDF.py\", line 54, in <module>\n    df_cdf.to_netcdf(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/core/dataset.py\", line 1901, in to_netcdf\n    return to_netcdf(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/api.py\", line 1055, in to_netcdf\n    store = store_open(target, mode, format, group, **kwargs)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 382, in open\n    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 330, in __init__\n    self.format = self.ds.data_model\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 391, in ds\n    return self._acquire()\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 385, in _acquire\n    with self._manager.acquire_context(needs_lock) as root:\n  File \"/opt/anaconda3/lib/python3.8/contextlib.py\", line 113, in __enter__\n    return next(self.gen)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 187, in acquire_context\n    file, cached = self._acquire_with_cache_info(needs_lock)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 205, in _acquire_with_cache_info\n    file = self._opener(*self._args, **kwargs)\n  File \"src/netCDF4/_netCDF4.pyx\", line 2307, in netCDF4._netCDF4.Dataset.__init__\n  File \"src/netCDF4/_netCDF4.pyx\", line 1925, in netCDF4._netCDF4._ensure_nc_success\nPermissionError: [Errno 13] Permission denied: b'/Users/uhhmed/localCMAQprediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc'\n",
  "history_begin_time" : 1661375396068,
  "history_end_time" : 1661375400000,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "oKwPOw4C2zWz",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\nprint(prediction_path)\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "/Users/uhhmed/localCMAQprediction_files/\noverall hourly files:  []\n20220805\nsingle day hourly files:  []\nTraceback (most recent call last):\n  File \"netCDF.py\", line 38, in <module>\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/util/_decorators.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 347, in concat\n    op = _Concatenator(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 404, in __init__\n    raise ValueError(\"No objects to concatenate\")\nValueError: No objects to concatenate\n",
  "history_begin_time" : 1661375383142,
  "history_end_time" : 1661375385455,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "rxnriNgMjfAq",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220806_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  []\n20220805\nsingle day hourly files:  []\nTraceback (most recent call last):\n  File \"netCDF.py\", line 38, in <module>\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/util/_decorators.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 347, in concat\n    op = _Concatenator(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 404, in __init__\n    raise ValueError(\"No objects to concatenate\")\nValueError: No objects to concatenate\n",
  "history_begin_time" : 1661375350885,
  "history_end_time" : 1661375353476,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "baJpiFSIY7aq",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n#     df_cdf = xr.open_dataset(\n#         \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n    df_cdf = xr.open_dataset(\n        \"/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  []\n20220805\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 199, in _acquire_with_cache_info\n    file = self._cache[self._key]\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/lru_cache.py\", line 53, in __getitem__\n    value = self._cache[key]\nKeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_extracted.nc',), 'r', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False))]\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"netCDF.py\", line 31, in <module>\n    df_cdf = xr.open_dataset(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/api.py\", line 495, in open_dataset\n    backend_ds = backend.open_dataset(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 553, in open_dataset\n    store = NetCDF4DataStore.open(\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 382, in open\n    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 330, in __init__\n    self.format = self.ds.data_model\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 391, in ds\n    return self._acquire()\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 385, in _acquire\n    with self._manager.acquire_context(needs_lock) as root:\n  File \"/opt/anaconda3/lib/python3.8/contextlib.py\", line 113, in __enter__\n    return next(self.gen)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 187, in acquire_context\n    file, cached = self._acquire_with_cache_info(needs_lock)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 205, in _acquire_with_cache_info\n    file = self._opener(*self._args, **kwargs)\n  File \"src/netCDF4/_netCDF4.pyx\", line 2307, in netCDF4._netCDF4.Dataset.__init__\n  File \"src/netCDF4/_netCDF4.pyx\", line 1925, in netCDF4._netCDF4._ensure_nc_success\nFileNotFoundError: [Errno 2] No such file or directory: b'/Users/uhhmed/localCMAQ/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_extracted.nc'\n",
  "history_begin_time" : 1661375275625,
  "history_end_time" : 1661375278987,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "fwvvveLI8cRJ",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661152049187,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "Ayo4xkwRy89b",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661149461817,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "6zkoMZxM5YqK",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661146054646,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "lBiJoAQdVMun",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1661048151663,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "3lt9gUMKq3dY",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660978925791,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "2zpcqpjxm9n",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660969494563,
  "history_end_time" : 1660973594856,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "btipCQAx6WBG",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660965680548,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "us887bYdS8UA",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660947599604,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "oEx5gD7Fputp",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660905346104,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "PDJe41ha99C0",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660882625685,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "yCcZht33wY8K",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660875567399,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "jazHSZpObuLP",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "Traceback (most recent call last):\n  File \"netCDF.py\", line 12, in <module>\n    create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n  File \"/home/aalnaim/gw-workspace/jazHSZpObuLP/cmaq_ai_utils.py\", line 37, in create_and_clean_folder\n    os.remove(os.path.join(folder_path, f))\nOSError: [Errno 16] Device or resource busy: '/groups/ESS/aalnaim/cmaq//prediction_nc_files/.nfs000000000229403c00000eff'\n",
  "history_begin_time" : 1660875327102,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "hSykER9z1Rqn",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "Traceback (most recent call last):\n  File \"netCDF.py\", line 12, in <module>\n    create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n  File \"/home/aalnaim/gw-workspace/hSykER9z1Rqn/cmaq_ai_utils.py\", line 37, in create_and_clean_folder\n    os.remove(os.path.join(folder_path, f))\nOSError: [Errno 16] Device or resource busy: '/groups/ESS/aalnaim/cmaq//prediction_nc_files/.nfs000000000229403c00000eff'\n",
  "history_begin_time" : 1660875224548,
  "history_end_time" : null,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Running"
},{
  "history_id" : "8azqca7P83m8",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "Traceback (most recent call last):\n  File \"netCDF.py\", line 12, in <module>\n    create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n  File \"/home/aalnaim/gw-workspace/8azqca7P83m8/cmaq_ai_utils.py\", line 37, in create_and_clean_folder\n    os.remove(os.path.join(folder_path, f))\nOSError: [Errno 16] Device or resource busy: '/groups/ESS/aalnaim/cmaq//prediction_nc_files/.nfs000000000229403c00000eff'\n",
  "history_begin_time" : 1660875182107,
  "history_end_time" : 1660875215370,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "4vaFFpoWKhgQ",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "Traceback (most recent call last):\n  File \"netCDF.py\", line 12, in <module>\n    create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n  File \"/home/aalnaim/gw-workspace/4vaFFpoWKhgQ/cmaq_ai_utils.py\", line 37, in create_and_clean_folder\n    os.remove(os.path.join(folder_path, f))\nOSError: [Errno 16] Device or resource busy: '/groups/ESS/aalnaim/cmaq//prediction_nc_files/.nfs000000000229403c00000eff'\n",
  "history_begin_time" : 1660875101528,
  "history_end_time" : 1660875215840,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "hmjsurpodkm",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660874330505,
  "history_end_time" : 1660874422095,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "ujobsq0g9zy",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660873762012,
  "history_end_time" : 1660873854542,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "gB7cR7V54LBe",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660873282196,
  "history_end_time" : 1660875217163,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "YDMZy8ZzW7C7",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660872957599,
  "history_end_time" : 1660875217725,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "OzEiB1XJeGua",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660871874326,
  "history_end_time" : 1660875218297,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "1h7VIRkJRRoh",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files/\")\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660869228212,
  "history_end_time" : 1660875218929,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : null,
  "indicator" : "Stopped"
},{
  "history_id" : "heo7awir74j",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nTraceback (most recent call last):\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 199, in _acquire_with_cache_info\n    file = self._cache[self._key]\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/lru_cache.py\", line 53, in __getitem__\n    value = self._cache[key]\nKeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc',), 'a', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False))]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"netCDF.py\", line 51, in <module>\n    df_cdf.to_netcdf(\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/core/dataset.py\", line 1901, in to_netcdf\n    return to_netcdf(\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/api.py\", line 1055, in to_netcdf\n    store = store_open(target, mode, format, group, **kwargs)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 382, in open\n    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 330, in __init__\n    self.format = self.ds.data_model\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 391, in ds\n    return self._acquire()\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 385, in _acquire\n    with self._manager.acquire_context(needs_lock) as root:\n  File \"/opt/sw/spack/apps/linux-centos8-x86_64/gcc-9.3.0/python-3.8.6-ff/lib/python3.8/contextlib.py\", line 113, in __enter__\n    return next(self.gen)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 187, in acquire_context\n    file, cached = self._acquire_with_cache_info(needs_lock)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 205, in _acquire_with_cache_info\n    file = self._opener(*self._args, **kwargs)\n  File \"src/netCDF4/_netCDF4.pyx\", line 2307, in netCDF4._netCDF4.Dataset.__init__\n  File \"src/netCDF4/_netCDF4.pyx\", line 1925, in netCDF4._netCDF4._ensure_nc_success\nPermissionError: [Errno 13] Permission denied: b'/groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc'\n",
  "history_begin_time" : 1660869128212,
  "history_end_time" : 1660869146436,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Failed"
},{
  "history_id" : "l85ce1hd9qm",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660868812328,
  "history_end_time" : 1660868966592,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "2y3kc67qlxf",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nTraceback (most recent call last):\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 199, in _acquire_with_cache_info\n    file = self._cache[self._key]\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/lru_cache.py\", line 53, in __getitem__\n    value = self._cache[key]\nKeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc',), 'a', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False))]\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"netCDF.py\", line 51, in <module>\n    df_cdf.to_netcdf(\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/core/dataset.py\", line 1901, in to_netcdf\n    return to_netcdf(\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/api.py\", line 1055, in to_netcdf\n    store = store_open(target, mode, format, group, **kwargs)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 382, in open\n    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 330, in __init__\n    self.format = self.ds.data_model\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 391, in ds\n    return self._acquire()\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/netCDF4_.py\", line 385, in _acquire\n    with self._manager.acquire_context(needs_lock) as root:\n  File \"/opt/sw/spack/apps/linux-centos8-x86_64/gcc-9.3.0/python-3.8.6-ff/lib/python3.8/contextlib.py\", line 113, in __enter__\n    return next(self.gen)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 187, in acquire_context\n    file, cached = self._acquire_with_cache_info(needs_lock)\n  File \"/home/aalnaim/CMAQAI/lib/python3.8/site-packages/xarray/backends/file_manager.py\", line 205, in _acquire_with_cache_info\n    file = self._opener(*self._args, **kwargs)\n  File \"src/netCDF4/_netCDF4.pyx\", line 2307, in netCDF4._netCDF4.Dataset.__init__\n  File \"src/netCDF4/_netCDF4.pyx\", line 1925, in netCDF4._netCDF4._ensure_nc_success\nPermissionError: [Errno 13] Permission denied: b'/groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc'\n",
  "history_begin_time" : 1660868143168,
  "history_end_time" : 1660868161840,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Failed"
},{
  "history_id" : "bu3dsqnjyhx",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\nsdate = date(2022, 8, 5)   # start date\nedate = date(2022, 8, 6)   # end date\ndays = get_days_list(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}prediction_files/\"\n\n# df_csv['YYYYMMDDHH'] = df_csv['YYYYMMDDHH'].astype(str)\n# print(df_csv['YYYYMMDDHH'].unique())\n# df_filt = df_csv[df_csv['YYYYMMDDHH'].str.contains(days[1]+\"|\"+days[0]+\"|\"+days[2], case = False, regex=True)] #this line seems unnecessary\n# df_filt = df_filt[(df_filt['YYYYMMDDHH'] > days[0]+'11') & (df_filt['YYYYMMDDHH'] < days[1]+'12')]\n# print(df_filt['YYYYMMDDHH'].unique())\n\n# Reshape \"prediction/Latitude/Longitude\" columns to (TSTEP, ROW, COL), these lines will reshape data into (24, 265, 442)\n#reshaped_prediction = np.atleast_3d(df_filt['prediction']).reshape(-1, 265, 442)\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\nprint(\"overall hourly files: \", all_hourly_files)\n\nfor i in range(1):\n    print(days[i])\n\n    df_cdf = xr.open_dataset(\n        \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\" + days[i + 1] + \"_extracted.nc\")\n\n    print(\"single day hourly files: \", all_hourly_files[i * 24:(i + 1) * 24])\n    df_from_each_hourly_file = (pd.read_csv(f)\n                                for f in all_hourly_files[i * 24:(i + 1) * 24])\n\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n    reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 265, 442)\n    print(reshaped_prediction.shape)\n\n    # Remove \"LAY\" Dimension in O3 variable already in nc file.\n    reduced_dim = df_cdf['O3'].sel(LAY=1, drop=True)\n\n    # Swap values from original nc file with new prediction data\n    reduced_dim.values = reshaped_prediction\n\n    # Apply changes to data variable in nc file\n    df_cdf['O3'] = (['TSTEP', 'ROW', 'COL'], reshaped_prediction)\n    df_cdf = df_cdf[['O3', 'TFLAG']]\n    \n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n    df_cdf.to_netcdf(\n        f'{cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n\n    print(\n        f'Saved updated netCDF file: {cmaq_folder}prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_' + days[i] + '_ML_extracted.nc')\n",
  "history_output" : "overall hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080612.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080613.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080614.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080615.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080616.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080617.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080618.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080619.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080620.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080621.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080622.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080623.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080700.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080701.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080702.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080703.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080704.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080705.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080706.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080707.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080708.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080709.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080710.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080711.csv']\n20220805\nsingle day hourly files:  ['/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080512.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080513.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080514.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080515.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080516.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080517.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080518.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080519.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080520.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080521.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080522.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080523.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080600.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080601.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080602.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080603.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080604.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080605.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080606.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080607.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080608.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080609.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080610.csv', '/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf_2022080611.csv']\n(24, 265, 442)\nSaved updated netCDF file: /groups/ESS/aalnaim/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20220805_ML_extracted.nc\n",
  "history_begin_time" : 1660866184690,
  "history_end_time" : 1660867734994,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "47k8s2onsa9",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660874120828,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "f4jexlvv2sq",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660874838802,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},{
  "history_id" : "hcr4i76z57t",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1660881959465,
  "history_notes" : null,
  "history_process" : "eq05y9",
  "host_id" : "p6wvf2",
  "indicator" : "Stopped"
},]
