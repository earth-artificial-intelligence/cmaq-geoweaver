[{
  "history_id" : "t6cs41q8ym7",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149867,
  "history_end_time" : 1675826081450,
  "history_notes" : null,
  "history_process" : "6up921",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "zturcew8pn2",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149868,
  "history_end_time" : 1675826081451,
  "history_notes" : null,
  "history_process" : "xpdg66",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "48rpszti0tw",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149869,
  "history_end_time" : 1675826081451,
  "history_notes" : null,
  "history_process" : "xlayd5",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "3cexlojnscs",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149869,
  "history_end_time" : 1675826081451,
  "history_notes" : null,
  "history_process" : "argv3i",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "b2n0av8bzqz",
  "history_input" : "# use the trained model to predict on the testing data and save the results to prediction_rf.csv\n\nimport pandas as pd\nimport pickle\nfrom pathlib import Path\nfrom time import sleep\nimport glob, os\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom cmaq_ai_utils import *\n\ncreate_and_clean_folder(f\"{cmaq_folder}/prediction_files/\")\n\n# importing data\n# final=pd.read_csv(f\"{cmaq_folder}/testing_input_hourly/testing.csv\")\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\n\n# load the model from disk\n# filename = f'{cmaq_folder}/models/rf_pycaret.sav'\n\nfilename = f'{model_folder}/rf_pycaret_o3_one_year_good.sav'\nloaded_model = pickle.load(open(filename, 'rb'))\n\nfor testing_df in df_from_each_hourly_file:\n  #print(testing_df['YYYYMMDDHH'].values[0])\n  file_dateTime = testing_df['YYYYMMDDHH'].values[0]\n  #X = testing_df.drop(['YYYYMMDDHH','Latitude','Longitude'],axis=1)\n  testing_df['time_of_day'] = (testing_df['hours'] % 24 + 4) // 4\n\n  # Make coords even more coarse by rounding to closest multiple of 5 \n  # (e.g., 40, 45, 85, 55)\n  #testing_df['Latitude_ExtraCoarse'] = 0.1 * round(testing_df['Latitude']/0.1)\n  #testing_df['Longitude_ExtraCoarse'] = 0.1 * round(testing_df['Longitude']/0.1)\n  X = testing_df.drop(['YYYYMMDDHH','Latitude','Longitude', 'CO(moles/s)'],axis=1)\n  \n  #print(X.columns)\n\n# # making prediction\n  pred = loaded_model.predict(X)\n\n# adding prediction values to test dataset\n  #testing_df['prediction'] = testing_df['CMAQ12KM_O3(ppb)'].tolist()\n  testing_df['prediction'] = pred\n\n  testing_df = testing_df[['Latitude', 'Longitude','YYYYMMDDHH','prediction']]\n# saving the dataset into local drive\n  print(f'Saving: {cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv')\n  testing_df.to_csv(f'{cmaq_folder}/prediction_files/prediction_rf_{file_dateTime}.csv',index=False)",
  "history_output" : "Saving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020204.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020203.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020123.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020118.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020116.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020202.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020205.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020117.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020119.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020122.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020113.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020114.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020210.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020121.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020206.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020201.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020208.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020211.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020120.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020115.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020112.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020209.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020200.csv\nSaving: /groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020207.csv\n",
  "history_begin_time" : 1675825260145,
  "history_end_time" : 1675826081451,
  "history_notes" : null,
  "history_process" : "l8vlic",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "wih9ys3g1cf",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149876,
  "history_end_time" : 1675826081452,
  "history_notes" : null,
  "history_process" : "wny2dz",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "nex3hkktd3a",
  "history_input" : "# load the prediction_rf.csv into a NetCDF file for visualization\nfrom cmaq_ai_utils import *\n\n# end_date = datetime.today()\n# base = end_date - timedelta(days=2)\n#sdate = date(2022, 8, 6)   # start date\n#edate = date(2022, 8, 8)   # end date\ntoday = datetime.today()\nedate = today\nsdate = today - timedelta(days=7)\ndays = get_days_list_for_prediction(sdate, edate)\n\nprediction_path = f\"{cmaq_folder}/prediction_files/\"\n\nall_hourly_files = sorted(glob.glob(os.path.join(prediction_path, \"*.csv\")))\n# print(\"overall hourly files: \", all_hourly_files)\nreal_hour_list = [12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11]\ntime_step_in_netcdf_list = range(0,24)\n\nfor i in range(len(days)-1):\n  print(days[i])\n  current_day = days[i]\n  next_day = days[i+1]\n  \n  cmaq_cdf_file = \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\"+current_day+\"_extracted.nc\"\n  \n  target_cdf_file = f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_'+current_day+'_ML_extracted.nc'\n  \n  if not os.path.exists(cmaq_cdf_file):\n    print(f\"{cmaq_cdf_file} doesn't exist\")\n    continue\n    \n  if os.path.exists(target_cdf_file):\n    print(f\"{target_cdf_file} already exists\")\n    continue\n  \n  df_cdf = xr.open_dataset(cmaq_cdf_file)\n  daily_hourly_files = []\n  for k in real_hour_list:\n    real_hour_value = real_hour_list[k]\n    if real_hour_value<12:\n      day = next_day\n    else:\n      day = current_day\n    #daily_hourly_files.append(f'{test_folder}/test_data_{day}_{turn_2_digits(real_hour_value)}.csv')\n    daily_hourly_files.append(f'{cmaq_folder}/prediction_files/prediction_rf_{day}{turn_2_digits(real_hour_value)}.csv')\n  \n  daily_hourly_files = sorted(daily_hourly_files)\n  #print(\"single day hourly files: \", all_hourly_files[i*24:(i+1)*24])\n  print(\"single day hourly files: \", daily_hourly_files)\n  df_from_each_hourly_file = (pd.read_csv(f) for f in daily_hourly_files)\n  \n  df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n  reshaped_prediction = df_csv['prediction'].to_numpy().reshape(24, 1, 265, 442).astype(np.float32)\n  print(reshaped_prediction.shape)\n  \n  # retain only two essential variables\n  clean_df_cdf = df_cdf[['O3', 'TFLAG']]\n  \n  # reduce VAR dim to 1\n  new_tflag = df_cdf['TFLAG'].to_numpy()\n  new_tflag = new_tflag[:, 0, :].reshape(24, 1, 2)\n  \n  # Apply changes to data variable in nc file\n  clean_df_cdf['O3'] = (['TSTEP', 'LAY', 'ROW', 'COL'], reshaped_prediction)\n  clean_df_cdf['TFLAG'] = (['TSTEP', 'VAR', 'DATE-TIME'], new_tflag)\n\n#   create_and_clean_folder(f\"{cmaq_folder}/prediction_nc_files\")\n  clean_df_cdf.to_netcdf(target_cdf_file)\n\n  print(f'Saved updated netCDF file: {target_cdf_file}')\n  ",
  "history_output" : "20230131\n/groups/ESS/zsun/cmaq//prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230131_ML_extracted.nc already exists\n20230201\nsingle day hourly files:  ['/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020112.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020113.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020114.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020115.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020116.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020117.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020118.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020119.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020120.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020121.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020122.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020123.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020200.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020201.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020202.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020203.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020204.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020205.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020206.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020207.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020208.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020209.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020210.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020211.csv']\n(24, 1, 265, 442)\nSaved updated netCDF file: /groups/ESS/zsun/cmaq//prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230201_ML_extracted.nc\n20230202\nsingle day hourly files:  ['/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020212.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020213.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020214.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020215.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020216.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020217.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020218.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020219.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020220.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020221.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020222.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020223.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020300.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020301.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020302.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020303.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020304.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020305.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020306.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020307.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020308.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020309.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020310.csv', '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020311.csv']\nTraceback (most recent call last):\n  File \"processing_test_netcdf.py\", line 53, in <module>\n    df_csv = pd.concat(df_from_each_hourly_file, ignore_index=True)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/util/_decorators.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 346, in concat\n    op = _Concatenator(\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py\", line 400, in __init__\n    objs = list(objs)\n  File \"processing_test_netcdf.py\", line 51, in <genexpr>\n    df_from_each_hourly_file = (pd.read_csv(f) for f in daily_hourly_files)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/util/_decorators.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/io/parsers/readers.py\", line 680, in read_csv\n    return _read(filepath_or_buffer, kwds)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/io/parsers/readers.py\", line 575, in _read\n    parser = TextFileReader(filepath_or_buffer, **kwds)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/io/parsers/readers.py\", line 933, in __init__\n    self._engine = self._make_engine(f, self.engine)\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/io/parsers/readers.py\", line 1217, in _make_engine\n    self.handles = get_handle(  # type: ignore[call-overload]\n  File \"/home/zsun/anaconda3/lib/python3.8/site-packages/pandas/io/common.py\", line 789, in get_handle\n    handle = open(\nFileNotFoundError: [Errno 2] No such file or directory: '/groups/ESS/zsun/cmaq//prediction_files/prediction_rf_2023020212.csv'\n",
  "history_begin_time" : 1675825766616,
  "history_end_time" : 1675826081452,
  "history_notes" : null,
  "history_process" : "3asyzj",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "5m2q90omney",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149879,
  "history_end_time" : 1675826081452,
  "history_notes" : null,
  "history_process" : "9xdvh6",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "aukbsxdomja",
  "history_input" : "# get hourly CMAQ data into csv for prediction\n\nfrom cmaq_ai_utils import *\n\n\n#edate = datetime.today()\n#sdate = edate - timedelta(days=1)\n# today = datetime.today()\n# edate = today\n# sdate = today - timedelta(days=days_back)\n\n#sdate = date(2022, 8, 6)   # start date\n#edate = date(2022, 8, 8)   # end date\n# days = get_days_list_for_prediction(sdate, edate)\n\nreal_hour_list = [12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11]\ntime_step_in_netcdf_list = range(0,24)\n\ntest_folder = f\"{cmaq_folder}/testing_input_hourly/\"\ncreate_and_clean_folder(test_folder)\n\nfor x in range(len(days)-1):\n  current_day = days[x]\n  next_day = days[x+1]\n  print(\"Getting data for: \"+current_day)\n  \n  # read cmaq results\n  cmaq_file = \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/CCTMout/12km/POST/COMBINE3D_ACONC_v531_gcc_AQF5X_\"+current_day+\"_extracted.nc\"\n  if not os.path.exists(cmaq_file):\n    print(f\"CMAQ file {cmaq_file} doesn't exist\")\n    continue\n  \n  target_cdf_file = f'{cmaq_folder}/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_'+current_day+'_ML_extracted.nc'\n    \n  if os.path.exists(target_cdf_file):\n    print(f\"{target_cdf_file} already exists\")\n    continue\n  \n  df_cmaq = xr.open_dataset(cmaq_file)\n  \n  # read mcip results \n  mcip_file = \"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/mcip/12km/METCRO2D_\"+current_day+\".nc\"\n  df_mcip = xr.open_dataset(mcip_file)\n  \n  # read emissions results \n  df_emis = xr.open_dataset(\"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/emis2021/12km/all/emis_mole_all_\"+current_day+\"_AQF5X_cmaq_cb6ae7_2017gb_17j.ncf\")\n  \n  for k in time_step_in_netcdf_list:\n    real_hour_value = real_hour_list[k]\n    \n    if real_hour_value<12:\n      day = next_day\n    else:\n      day = current_day\n    \n    df_hourly = pd.DataFrame()\n    \n    #print(\"df_cmaq.variables['O3'] shape: \", df_cmaq.variables['O3'].shape)\n    #print(\"df_cmaq.variables['O3'][:] shape: \", df_cmaq.variables['O3'][:].shape)\n    #print(\"df_cmaq.variables['O3'][:].values[k, 0].shape\", df_cmaq.variables['O3'][:].values[k, 0].shape)\n    # CMAQ data\n    # O3 variable\n    o3=df_cmaq.variables['O3'][:].values[k, 0]\n    cmaq_O3=list(np.ravel(o3).transpose())\n    #print(\"o3 shape: \", o3.shape)\n    #print(\"cmaq_O3 shape: \", np.ravel(o3).transpose().shape)\n    \n    # NO2\n    no2=df_cmaq.variables['NO2'][:].values[k, 0]\n    cmaq_NO2=list(np.ravel(no2).transpose())\n    \n    # CO\n    co=df_cmaq.variables['CO'][:].values[k, 0]\n    cmaq_CO=list(np.ravel(co).transpose())\n    \n    # PM25_CO\n    pm25=df_cmaq.variables['PM25_OC'][:].values[k, 0]\n    cmaq_PM25_CO=list(np.ravel(pm25).transpose())\n    \n    # EMIS data\n    co_emis=df_emis.variables['CO'][:].values[k, 0]\n    CO_emi=list(np.ravel(co_emis).transpose())    \n    \n    # MCIP data\n    # CO variable\n    prsfc=df_mcip.variables['PRSFC'][:].values[k, 0]\n    PRSFC=list(np.ravel(prsfc).transpose())\n    \n    # NO2\n    pbl=df_mcip.variables['PBL'][:].values[k, 0]\n    PBL=list(np.ravel(pbl).transpose())\n    \n    # TEMP2\n    temp2=df_mcip.variables['TEMP2'][:].values[k, 0]\n    TEMP2=list(np.ravel(temp2).transpose())\n    \n    # WSPD10\n    wspd10=df_mcip.variables['WSPD10'][:].values[k, 0]\n    WSPD10=list(np.ravel(wspd10).transpose())\n    \n    # WDIR10\n    wdir10=df_mcip.variables['WDIR10'][:].values[k, 0]\n    WDIR10=list(np.ravel(wdir10).transpose())\n    \n    # RGRND\n    rgrnd=df_mcip.variables['RGRND'][:].values[k, 0]\n    RGRND=list(np.ravel(rgrnd).transpose())\n    \n    # CFRAC\n    cfrac=df_mcip.variables['CFRAC'][:].values[k, 0]\n    CFRAC=list(np.ravel(cfrac).transpose())\n    \n    ## LAT/LON data\n    df_coords = xr.open_dataset('/home/yli74/scripts/plots/2020fire/GRIDCRO2D')\n    \n    lat = df_coords.variables['LAT'][:].values[0,0]\n    #print(\"lat shape\", lat.shape)\n    lat_flt=np.ravel(lat)\n    LAT=lat_flt #np.tile(lat_flt,1)\n    \n    lon = df_coords.variables['LON'][:].values[0,0]\n    lon_flt=np.ravel(lon)\n    LON=lon_flt #np.tile(lon_flt,1)\n    \n    df_hourly['Latitude'] = LAT\n    df_hourly['Longitude'] = LON\n    df_hourly['YYYYMMDDHH'] = day+turn_2_digits(real_hour_value)\n    df_hourly['CMAQ12KM_O3(ppb)'] = cmaq_O3\n    df_hourly['CMAQ12KM_NO2(ppb)'] = cmaq_NO2\n    df_hourly['CMAQ12KM_CO(ppm)'] = cmaq_CO\n    df_hourly['CMAQ_OC(ug/m3)'] = cmaq_PM25_CO\n    df_hourly['CO(moles/s)'] = CO_emi\n    df_hourly['PRSFC(Pa)'] = PRSFC\n    df_hourly['PBL(m)'] = PBL\n    df_hourly['TEMP2(K)'] = TEMP2\n    df_hourly['WSPD10(m/s)'] = WSPD10\n    df_hourly['WDIR10(degree)'] = WDIR10\n    df_hourly['RGRND(W/m2)'] = RGRND\n    df_hourly['CFRAC'] = CFRAC\n    df_hourly['month'] = df_hourly['YYYYMMDDHH'].str[4:6]\n    df_hourly['day'] = df_hourly['YYYYMMDDHH'].str[6:8]\n    df_hourly['hours'] = df_hourly['YYYYMMDDHH'].str[8:10]\n    print(f'Saving file: test_data_{day}_{turn_2_digits(real_hour_value)}.csv')\n    df_hourly.to_csv(f'{test_folder}/test_data_{day}_{turn_2_digits(real_hour_value)}.csv',index=False)\n\nprint('Done with preparing testing data!')",
  "history_output" : "",
  "history_begin_time" : 1675825150487,
  "history_end_time" : 1675826081452,
  "history_notes" : null,
  "history_process" : "ex3vh9",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "jq8gxsb6uy5",
  "history_input" : "# merge all hourly testing data into daily files\n\nimport pandas as pd\nimport glob\nimport os\nfrom pathlib import Path\nfrom cmaq_ai_utils import *\n\ntesting_path = f'{cmaq_folder}/testing_input_hourly'\nall_hourly_files = glob.glob(os.path.join(testing_path, \"test_data_*.csv\"))   \n# advisable to use os.path.join as this makes concatenation OS independent\n\ndf_from_each_hourly_file = (pd.read_csv(f) for f in all_hourly_files)\ncmaq = pd.concat(df_from_each_hourly_file, ignore_index=True)\n\n# dropping unnecessary variables\ncmaq['YYYYMMDDHH'] = cmaq['YYYYMMDDHH'].map(str)\ncmaq['month'] = cmaq['YYYYMMDDHH'].str[4:6]\ncmaq['day'] = cmaq['YYYYMMDDHH'].str[6:8]\ncmaq['hours'] = cmaq['YYYYMMDDHH'].str[8:10]\n\nremove_file(f\"{testing_path}/testing.csv\")\ncmaq.to_csv(f\"{testing_path}/testing.csv\",index=False)\n\nprint('Done with generating testing.csv!')",
  "history_output" : "remove old files/groups/ESS/zsun/cmaq//testing_input_hourly/testing.csv\nDone with generating testing.csv!\n",
  "history_begin_time" : 1675825172816,
  "history_end_time" : 1675826081453,
  "history_notes" : null,
  "history_process" : "b8uv5z",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "gspazcxwtfk",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1675826081453,
  "history_notes" : null,
  "history_process" : "is1w3m",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "3i7x8ltmjq4",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149885,
  "history_end_time" : 1675826081456,
  "history_notes" : null,
  "history_process" : "h76ld0",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "m0756bmcn9e",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149885,
  "history_end_time" : 1675826081457,
  "history_notes" : null,
  "history_process" : "s6hbic",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "4w4s9odx798",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149885,
  "history_end_time" : 1675826081457,
  "history_notes" : null,
  "history_process" : "pvzabv",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "tj2botlm02i",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1675825149886,
  "history_end_time" : 1675826081458,
  "history_notes" : null,
  "history_process" : "8i9ptn",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "skwnkfj42tk",
  "history_input" : "#!/bin/bash\n# generate images and gif from the NetCDF files\n\ncmaq_folder=\"/groups/ESS/zsun/cmaq\"\npermanent_location=\"/groups/ESS3/zsun/cmaq/ai_results/\"\nmkdir $cmaq_folder\"/plots\"\n\n\nexport postdata_dir=$cmaq_folder\"/prediction_nc_files\"\nexport mcip_dir=\"/groups/ESS/share/projects/SWUS3km/data/cmaqdata/mcip/12km\"\nexport dir_graph=$cmaq_folder\"/plots\"\n\necho \"Loading NCL\"\nsource /home/zsun/.bashrc\nmodule load ncl\necho \"Loaded NCL\"\n\nrm $cmaq_folder/geoweaver_plot_daily_O3.ncl\n\necho \"Drafting \"$cmaq_folder/geoweaver_plot_daily_O3.ncl\ncat <<EOF >> $cmaq_folder/geoweaver_plot_daily_O3.ncl\nload \"/opt/sw/spack/apps/linux-centos8-cascadelake/gcc-9.3.0-openmpi-4.0.4/ncl-6.6.2-fr/lib/ncarg/nclscripts/csm/gsn_code.ncl\"\nload \"/opt/sw/spack/apps/linux-centos8-cascadelake/gcc-9.3.0-openmpi-4.0.4/ncl-6.6.2-fr/lib/ncarg/nclscripts/csm/gsn_csm.ncl\"\nload \"/opt/sw/spack/apps/linux-centos8-cascadelake/gcc-9.3.0-openmpi-4.0.4/ncl-6.6.2-fr/lib/ncarg/nclscripts/csm/contributed.ncl\"\n\nsetvalues NhlGetWorkspaceObjectId()\n\"wsMaximumSize\": 600000000\nend setvalues\n\nbegin\n\nprint(\"NCL script successfully begin: \")\n\ndate = getenv(\"YYYYMMDD_POST\")\nd1 = getenv(\"stdate_post\")\nd2 = getenv(\"eddate_post\")\n\ndFile1 = getenv(\"stdate_file\")\ndFile2 = getenv(\"eddate_file\")\n\n;print(\"Passed Date: \"+date)\n\n;aconc_dir = getenv(\"postdata_dir\")\ngrid_dir = getenv(\"mcip_dir\")\nplot_dir = getenv(\"dir_graph\")\n\nprint(\"/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_\"+dFile1+\"_ML_extracted.nc\")\ncdf_file1 = addfile(\"/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_\"+dFile1+\"_ML_extracted.nc\",\"r\")\ncdf_file= addfile(grid_dir+\"/GRIDCRO2D_\"+date+\".nc\",\"r\")\n\nptime = (/\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"00\",\"01\",\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\"/)\n\ntime = cdf_file1->TFLAG(:,0,:)\no3 = cdf_file1->O3(:,0,:,:) ;ppb\n;pm25 = cdf_file1->PM25_TOT(:,0,:,:)\n\n\nnt = dimsizes(o3(:,0,0))\nny = dimsizes(o3(0,:,0))\nnx = dimsizes(o3(0,0,:))\n\nprint(nt+\" \"+ny+\" \"+nx)\nprint(max(o3))\nprint(min(o3))\nprint(avg(o3))\n\n;print(max(pm25))\n;print(min(pm25))\n;print(avg(pm25))\n\n;print(time)\n\nlat = cdf_file->LAT(0,0,:,:)\nlon = cdf_file->LON(0,0,:,:)\n\no3@lat2d = lat\no3@lon2d = lon\n\nres = True\nres@gsnMaximize = True                ; maximize pot in frame\nres@gsnFrame = False               ; don't advance frame\nres@gsnDraw = False\n;res@gsnSpreadColors = True\nres@lbLabelAutoStride = True\n;res@lbBoxLinesOn = False\nres@pmLabelBarHeightF = 0.1\nres@pmLabelBarWidthF = 0.5\nres@cnFillOn=True\n;res@cnMonoFillPattern=True\n;res@cnMonoLineColor=True\nres@cnLinesOn=False\n;res@pmLabelBarDisplayMode=\"never\"\nres@gsnLeftString  = \"\";\nres@gsnRightString = \"\"\n\nres@mpLimitMode = \"LatLon\"\nres@mpMinLonF = -120 ;min(lon)+0.2\nres@mpMaxLonF = -70 ;max(lon)-0.2\nres@mpMinLatF = 25 ;min(lat)+0.05\nres@mpMaxLatF = 50 ;max(lat)-0.05\nres@mpDataBaseVersion = \"MediumRes\"\n;res@tiMainString = times(it)\nres@mpDataBaseVersion       = \"MediumRes\"\nres@mpDataSetName           = \"Earth..4\"\nres@mpAreaMaskingOn         = True\nres@mpOutlineBoundarySets = \"GeophysicalAndUSStates\"\nres@mpOutlineSpecifiers=\"United States : States\"\nres@mpLandFillColor         = \"white\"\nres@mpInlandWaterFillColor  = \"white\"\nres@mpOceanFillColor        = \"white\"\nres@mpGeophysicalLineColor    = \"Black\"\nres@mpGeophysicalLineThicknessF = 1.5\n\n;res@gsnSpreadColors         = True\nres@lbLabelAutoStride       = True\nres@lbLabelFont             = 25\nres@tiXAxisFont             = 25\nres@pmTickMarkDisplayMode   = \"Always\"\nres@tmXBLabelFont           = 25\nres@tmXBLabelFontHeightF    = 0.013\nres@tmXBLabelDeltaF         = -0.5\nres@tmYLLabelFont           = 25\nres@tmYLLabelFontHeightF    = 0.013\nres@tmXBLabelDeltaF         = -0.5\nres@tmXTLabelsOn            = False\nres@tmXTLabelFont           = 25\nres@tmXTLabelFontHeightF    = 0.013\nres@tmYRLabelsOn            = False\nres@tmYRLabelFont           = 25\nres@tmYRLabelFontHeightF    = 0.013\n\n\nres@mpProjection           = \"LambertConformal\" ;\"CylindricalEquidistant\"\nres@mpLambertParallel1F    = 33.\nres@mpLambertParallel2F    = 45.\nres@mpLambertMeridianF     = -98.\n\nres@cnLevelSelectionMode = \"ManualLevels\"\nres@cnMinLevelValF          = 0.\nres@cnMaxLevelValF          = 80\nres@cnLevelSpacingF         = 4\n\nres@txFont   = \"times-roman\"\nres@tiMainFont   = \"times-roman\"\n\ndo it = 0, nt-1\n  if (it .lt. 12) then\n    pdate=d1\n  else\n    pdate=d2\n  end if\n\n  pname=plot_dir+\"/testPlot_\"+pdate+\"_\"+ptime(it)\n  wks = gsn_open_wks(\"png\",pname)\n  gsn_define_colormap(wks, \"WhiteBlueGreenYellowRed\")\n\n  res@tiMainString = pdate+\" \"+ptime(it)+\" UTC O~B~3~N~ Forecast (ppbV)\"\n  plot = gsn_csm_contour_map(wks,o3(it,:,:),res)\n  draw(plot)\n  frame(wks)\n  delete(wks)\n  system(\"composite -geometry 100x70+900+900 /groups/ESS/zsun/cmaq/mason-logo-green.png \"+pname+\".png \"+pname+\".png\")\nend do\ndelete(res)\n\nend\nexit\nEOF\n\necho \"Start to run the NCL script: \"$cmaq_folder\"/geoweaver_plot_daily_O3.ncl\"\n\necho \"ncl \"$cmaq_folder\"/geoweaver_plot_daily_O3.ncl\"\n\necho $(date -d '1 day ago' '+%Y%m%d')\n\ndays_back=30\n\nforce=false\n\nfor i in $(seq 1 $days_back)\ndo\n  end_day=$i\n  echo \"$end_day days ago\"\n  begin_day=$((i+1))\n  # Setting env variables\n  export YYYYMMDD_POST=$(date -d $begin_day' day ago' '+%Y%m%d') #This needs to be auto date `date -d \"-2 day ${1}\" +%Y%m%d`\n  #export YYYYMMDD_POST='20220806'\n  export stdate_post=$(date -d $begin_day' day ago' '+%Y-%m-%d') #This needs to be auto date\n  #export stdate_post='2022-08-06'\n  export eddate_post=$(date -d $end_day' day ago' '+%Y-%m-%d') #This needs to be auto date\n  #export eddate_post='2022-08-08'\n\n  export stdate_file=$(date -d $begin_day' day ago' '+%Y%m%d') #This needs to be auto date\n  #export stdate_file='20220806'\n  export eddate_file=$(date -d $end_day' day ago' '+%Y%m%d') #This needs to be auto date\n  #export eddate_file='20220808'\n  stdate_file=$(date -d $begin_day' day ago' '+%Y%m%d')\n  echo \"stdate_file=\"$stdate_file\n  # determine if the prediction netcdf is there\n  predict_nc_file=$cmaq_folder\"/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_\"$stdate_file\"_ML_extracted.nc\"\n  if [ -f \"$predict_nc_file\" ]; then\n    echo \"$predict_nc_file exists.\"\n  else\n    echo \"$predict_nc_file doesn't exist. Skipping...\"\n    continue\n  fi\n  \n  predict_gif_file=$permanent_location/gifs/Map_$YYYYMMDD_POST.gif\n  if [ \"$force\" != true ] ; then\n    if [ -f \"$predict_gif_file\" ]; then\n      echo \"$predict_gif_file exists. Skipping...\"\n      continue\n    else\n      echo \"$predict_gif_file doesn't exist. Generating...\"\n    fi\n  else\n    echo \"force to regenerate $predict_gif_file..\"\n  fi\n  \n  rm -rf $cmaq_folder/plots/* # clean everything in the folder first\n\n  ncl $cmaq_folder/geoweaver_plot_daily_O3.ncl\n\n  echo \"Finished \"$cmaq_folder\"/geoweaver_plot_daily_O3.ncl\"\n\n  # convert -delay 100 *.png 20220613_20220614.gif\n  convert -delay 100 $cmaq_folder/plots/testPlot*.png $cmaq_folder/plots/\"Map_\"$YYYYMMDD_POST.gif\n  echo \"Converted images to gif\"\n\n  # cp the results to permanent location\n  cp $predict_nc_file $permanent_location/netcdfs/\n  cp $cmaq_folder/plots/\"Map_\"$YYYYMMDD_POST.gif $permanent_location/gifs/\n  echo \"Moved the generated netcdfs and gifs to permanent locations\"\n  \ndone\n\n\n\nif [ $? -eq 0 ]; then\n    echo \"Generating images/gif Completed Successfully\"\nelse\n    echo \"Generating images/gif Failed!\"\nfi\n",
  "history_output" : "mkdir: cannot create directory ‘/groups/ESS/zsun/cmaq/plots’: File exists\nLoading NCL\nLoaded NCL\nDrafting /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\nStart to run the NCL script: /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\nncl /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\n20230206\n1 days ago\nstdate_file=20230205\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230205_ML_extracted.nc doesn't exist. Skipping...\n2 days ago\nstdate_file=20230204\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230204_ML_extracted.nc doesn't exist. Skipping...\n3 days ago\nstdate_file=20230203\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230203_ML_extracted.nc doesn't exist. Skipping...\n4 days ago\nstdate_file=20230202\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230202_ML_extracted.nc doesn't exist. Skipping...\n5 days ago\nstdate_file=20230201\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230201_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230201.gif doesn't exist. Generating...\n Copyright (C) 1995-2019 - All Rights Reserved\n University Corporation for Atmospheric Research\n NCAR Command Language Version 6.6.2\n The use of this software is governed by a License Agreement.\n See http://www.ncl.ucar.edu/ for more details.\n(0)\tNCL script successfully begin: \n(0)\t/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230201_ML_extracted.nc\n(0)\t24 265 442\n(0)\t63.365\n(0)\t1.823333\n(0)\t30.85139\nFinished /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\nConverted images to gif\ncp: cannot stat '/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230201_ML_extracted.nc': No such file or directory\nMoved the generated netcdfs and gifs to permanent locations\n6 days ago\nstdate_file=20230131\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230131_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230131.gif exists. Skipping...\n7 days ago\nstdate_file=20230130\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230130_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230130.gif exists. Skipping...\n8 days ago\nstdate_file=20230129\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230129_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230129.gif exists. Skipping...\n9 days ago\nstdate_file=20230128\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230128_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230128.gif exists. Skipping...\n10 days ago\nstdate_file=20230127\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230127_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230127.gif exists. Skipping...\n11 days ago\nstdate_file=20230126\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230126_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230126.gif exists. Skipping...\n12 days ago\nstdate_file=20230125\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230125_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230125.gif exists. Skipping...\n13 days ago\nstdate_file=20230124\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230124_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230124.gif exists. Skipping...\n14 days ago\nstdate_file=20230123\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230123_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230123.gif exists. Skipping...\n15 days ago\nstdate_file=20230122\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230122_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230122.gif exists. Skipping...\n16 days ago\nstdate_file=20230121\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230121_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230121.gif exists. Skipping...\n17 days ago\nstdate_file=20230120\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230120_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230120.gif exists. Skipping...\n18 days ago\nstdate_file=20230119\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230119_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230119.gif exists. Skipping...\n19 days ago\nstdate_file=20230118\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230118_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230118.gif doesn't exist. Generating...\n Copyright (C) 1995-2019 - All Rights Reserved\n University Corporation for Atmospheric Research\n NCAR Command Language Version 6.6.2\n The use of this software is governed by a License Agreement.\n See http://www.ncl.ucar.edu/ for more details.\n(0)\tNCL script successfully begin: \n(0)\t/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230118_ML_extracted.nc\nwarning:_NclOpenFile: cannot open file </groups/ESS/share/projects/SWUS3km/data/cmaqdata/mcip/12km/GRIDCRO2D_20230118.nc>; No such file or directory\n\n\nfatal:Number of subscripts do not match number of dimensions of variable, (4) subscripts used, (3) subscripts expected\n\nfatal:[\"Execute.c\":6377]:variable (O3) is not in file (cdf_file1)\n\nfatal:[\"Execute.c\":8637]:Execute: Error occurred at or near line 33 in file /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\n\n\nFinished /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\nconvert: unable to open image `/groups/ESS/zsun/cmaq/plots/testPlot*.png': No such file or directory @ error/blob.c/OpenBlob/2881.\nconvert: no images defined `/groups/ESS/zsun/cmaq/plots/Map_20230118.gif' @ error/convert.c/ConvertImageCommand/3226.\nConverted images to gif\ncp: cannot stat '/groups/ESS/zsun/cmaq/plots/Map_20230118.gif': No such file or directory\nMoved the generated netcdfs and gifs to permanent locations\n20 days ago\nstdate_file=20230117\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230117_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230117.gif doesn't exist. Generating...\n Copyright (C) 1995-2019 - All Rights Reserved\n University Corporation for Atmospheric Research\n NCAR Command Language Version 6.6.2\n The use of this software is governed by a License Agreement.\n See http://www.ncl.ucar.edu/ for more details.\n(0)\tNCL script successfully begin: \n(0)\t/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230117_ML_extracted.nc\nwarning:_NclOpenFile: cannot open file </groups/ESS/share/projects/SWUS3km/data/cmaqdata/mcip/12km/GRIDCRO2D_20230117.nc>; No such file or directory\n\n\nfatal:Number of subscripts do not match number of dimensions of variable, (4) subscripts used, (3) subscripts expected\n\nfatal:[\"Execute.c\":6377]:variable (O3) is not in file (cdf_file1)\n\nfatal:[\"Execute.c\":8637]:Execute: Error occurred at or near line 33 in file /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\n\n\nFinished /groups/ESS/zsun/cmaq/geoweaver_plot_daily_O3.ncl\nconvert: unable to open image `/groups/ESS/zsun/cmaq/plots/testPlot*.png': No such file or directory @ error/blob.c/OpenBlob/2881.\nconvert: no images defined `/groups/ESS/zsun/cmaq/plots/Map_20230117.gif' @ error/convert.c/ConvertImageCommand/3226.\nConverted images to gif\ncp: cannot stat '/groups/ESS/zsun/cmaq/plots/Map_20230117.gif': No such file or directory\nMoved the generated netcdfs and gifs to permanent locations\n21 days ago\nstdate_file=20230116\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230116_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230116.gif exists. Skipping...\n22 days ago\nstdate_file=20230115\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230115_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230115.gif exists. Skipping...\n23 days ago\nstdate_file=20230114\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230114_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230114.gif exists. Skipping...\n24 days ago\nstdate_file=20230113\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230113_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230113.gif exists. Skipping...\n25 days ago\nstdate_file=20230112\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230112_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230112.gif exists. Skipping...\n26 days ago\nstdate_file=20230111\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230111_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230111.gif exists. Skipping...\n27 days ago\nstdate_file=20230110\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230110_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230110.gif exists. Skipping...\n28 days ago\nstdate_file=20230109\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230109_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230109.gif exists. Skipping...\n29 days ago\nstdate_file=20230108\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230108_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230108.gif exists. Skipping...\n30 days ago\nstdate_file=20230107\n/groups/ESS/zsun/cmaq/prediction_nc_files/COMBINE3D_ACONC_v531_gcc_AQF5X_20230107_ML_extracted.nc exists.\n/groups/ESS3/zsun/cmaq/ai_results//gifs/Map_20230107.gif exists. Skipping...\nGenerating images/gif Completed Successfully\n",
  "history_begin_time" : 1675825812983,
  "history_end_time" : 1675826544447,
  "history_notes" : null,
  "history_process" : "iicy7w",
  "host_id" : "aqt8fv",
  "indicator" : "Done"
},{
  "history_id" : "f27xs73bxnc",
  "history_input" : "#!/bin/bash\n\ndays_back=30\n\npermanent_location=\"/groups/ESS3/zsun/cmaq/ai_results/\"\ncmaq_gif_location=\"/groups/ESS/share/projects/SWUS3km/graph/12km/\"\n\nfor i in $(seq 0 $days_back)\ndo\n  end_day=$i\n  echo \"$end_day days ago\"\n  begin_day=$((i))\n  # Setting env variables\n  YYYYMMDD_POST=$(date -d $begin_day' day ago' '+%Y%m%d')\n  #/groups/ESS/share/projects/SWUS3km/graph/12km/20221108/FORECAST_O3_20221108.gif\n  cp -u $cmaq_gif_location/$YYYYMMDD_POST/\"FORECAST_O3_\"$YYYYMMDD_POST.gif $permanent_location/gifs/\n  cp -u $cmaq_gif_location/$YYYYMMDD_POST/obsoverlay/gif/OBS-FORECAST_O3_$YYYYMMDD_POST.gif $permanent_location/gifs/\n  \ndone\n\n\n",
  "history_output" : "0 days ago\ncp: cannot stat '/groups/ESS/share/projects/SWUS3km/graph/12km//20230207/obsoverlay/gif/OBS-FORECAST_O3_20230207.gif': No such file or directory\n1 days ago\ncp: cannot stat '/groups/ESS/share/projects/SWUS3km/graph/12km//20230206/obsoverlay/gif/OBS-FORECAST_O3_20230206.gif': No such file or directory\n2 days ago\n3 days ago\n4 days ago\n5 days ago\n6 days ago\n7 days ago\n8 days ago\n9 days ago\n10 days ago\n11 days ago\n12 days ago\n13 days ago\n14 days ago\n15 days ago\n16 days ago\n17 days ago\n18 days ago\n19 days ago\n20 days ago\ncp: cannot stat '/groups/ESS/share/projects/SWUS3km/graph/12km//20230118/obsoverlay/gif/OBS-FORECAST_O3_20230118.gif': No such file or directory\n21 days ago\ncp: cannot stat '/groups/ESS/share/projects/SWUS3km/graph/12km//20230117/obsoverlay/gif/OBS-FORECAST_O3_20230117.gif': No such file or directory\n22 days ago\n23 days ago\n24 days ago\n25 days ago\n26 days ago\n27 days ago\n28 days ago\n29 days ago\n30 days ago\n",
  "history_begin_time" : 1675825149898,
  "history_end_time" : 1675826081460,
  "history_notes" : null,
  "history_process" : "nndpw6",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "7mqrmm6q4md",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1675826081461,
  "history_notes" : null,
  "history_process" : "gn54f0",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
},{
  "history_id" : "uicqtqho96y",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1675826081463,
  "history_notes" : null,
  "history_process" : "fsk7f2",
  "host_id" : "aqt8fv",
  "indicator" : "Stopped"
}]
